# CI Failure Triage - Issue #404

**Date:** 2026-02-10
**Issue:** #404 - AI Watchdog: PAUSE recommended (failures=20)
**Severity:** P2 (Medium - AI automation causing recurring failures)

## Summary

AI Watchdog detected 20 CI failures and recommended setting `AI_AUTOMATION_MODE=PAUSE`. Triage confirms recurring failures in AI-related workflows, specifically:
- AI Orchestrator
- AI Prerequisites Preflight Check

## Evidence

### Recent Failed Workflow Runs

| Workflow | Status | Timestamp (UTC) |
|----------|--------|-----------------|
| AI Orchestrator | failure | 2026-02-10T03:14:47Z |
| AI Prerequisites Preflight Check | failure | 2026-02-10T02:56:42Z |
| AI Prerequisites Preflight Check | failure | 2026-02-10T02:09:16Z |

### Analysis

1. **AI Watchdog Configuration:**
   - Runs every 15 minutes (cron: `*/15 * * * *`)
   - Monitors for CI failures
   - Creates issues when failure threshold is exceeded

2. **Root Cause Investigation:**
   - Failures appear in AI-related workflows that interact with external AI services
   - Potential causes:
     - API rate limiting or quota issues
     - Secret/credential issues
     - Network connectivity problems
     - Model service availability
     - Configuration drift in AI_AUTOMATION_MODE or related variables

3. **Current State:**
   - `AI_AUTOMATION_MODE` variable exists but current value unknown (API permissions prevent direct read)
   - AI automation continues to run every 15 minutes
   - Each failure consumes CI resources and potentially affects other workflows

## Recommended Actions

### Immediate (P2 - Manual Intervention Required)

1. **Set AI_AUTOMATION_MODE=PAUSE:**
   - Navigate to: Repository Settings > Actions > Variables
   - Create/update variable: `AI_AUTOMATION_MODE`
   - Set value: `PAUSE`
   - This will stop AI Orchestrator from creating new automated changes

2. **Review Recent Workflow Logs:**
   - Check AI Orchestrator logs for specific error messages
   - Check AI Prerequisites Preflight Check logs
   - Look for patterns in error messages (API errors, timeouts, etc.)

3. **Verify Required Variables:**
   Ensure these variables exist and are correctly set:
   - `AI_AUTOMATION_MODE` (set to PAUSE after review)
   - `AI_MAX_OPEN_AI_PRS`
   - `AI_MAX_ATTEMPTS_PER_ISSUE`

### Short-term (Next 24-48 hours)

1. **Fix Root Cause:**
   - Address specific errors found in workflow logs
   - If API issues: verify credentials, check quotas, contact service provider
   - If configuration issues: correct variable values

2. **Stabilize CI:**
   - Ensure CI passes on main branch
   - Address any blocking issues
   - Run manual CI verification

3. **Review AI Automation Behavior:**
   - Evaluate if AI automation is creating useful changes
   - Consider adjusting thresholds (e.g., increase AI_MAX_ATTEMPTS_PER_ISSUE)
   - Consider adding more guardrails or approval steps

### Long-term

1. **Enhance Monitoring:**
   - Add alerts for AI API rate limits
   - Monitor workflow success rates over time
   - Track PR quality and acceptance rates

2. **Improve Circuit Breakers:**
   - Consider adding exponential backoff for repeated failures
   - Implement automatic PAUSE after N consecutive failures (beyond current 20)
   - Add notifications to maintainers when threshold is reached

3. **Documentation:**
   - Document this incident in `docs/ai/lessons-learned.md`
   - Create runbook for "Red CI" incidents involving AI automation
   - Update `AGENTS.md` if new policies are needed

## Rollback Plan

If setting `AI_AUTOMATION_MODE=PAUSE` causes issues:
1. Revert to `AI_AUTOMATION_MODE=ACTIVE` or previous value
2. Monitor CI to ensure no regression
3. Document why PAUSE was not appropriate

## References

- Issue #404: AI Watchdog: PAUSE recommended
- Workflow: `.github/workflows/ai-watchdog.yml`
- Workflow: `.github/workflows/ai-orchestrator.yml`
- Workflow: `.github/workflows/ai-prereqs-check.yml`
- Incident Response: `docs/ops/incident-response.md`
- Session Log: `docs/ai/session-log/20260210_0514.md`
